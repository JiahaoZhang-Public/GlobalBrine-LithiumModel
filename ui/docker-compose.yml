services:
  ui-backend:
    build:
      context: ..
      dockerfile: ui/backend/Dockerfile
    environment:
      MODEL_DIR: /repo/models
      DATA_DIR: /repo/data/processed
      PREDICTIONS_CSV: /repo/data/predictions/brines_with_predictions.csv
      # Optional:
      # PREDICT_API_TOKEN: "change-me"
      # LIGHT_GEOTIFF_PATH: "/repo/data/external/GHI.tif"
      # LIGHT_SCALE: "0.0416666667"
    volumes:
      - ..:/repo
    ports:
      - "8000:8000"

  ui-frontend:
    build:
      context: ..
      dockerfile: ui/frontend/Dockerfile
    environment:
      BACKEND_URL: http://ui-backend:8000
    volumes:
      - ..:/repo
    ports:
      - "7860:7860"
    depends_on:
      - ui-backend
